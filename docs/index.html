<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小二的回合制卡牌游戏 - 大厅</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="hub.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
</head>
<body>

<div id="app">
    <!-- Auth Bar -->
    <div id="auth-bar">
        <div id="guest-bar">
            <button id="btn-open-auth" class="auth-btn">🔑 登录 / 注册</button>
        </div>
        <div id="user-bar" class="hidden">
            <span id="gold-display">🪙 0</span>
            <span id="user-name"></span>
            <button id="btn-logout" class="auth-btn auth-btn-sm">退出</button>
        </div>
        <a id="codex-link" href="codex.html">📖 图鉴</a>
    </div>

    <!-- Hub Header -->
    <header id="hub-header">
        <div class="hub-hero-frame">
            <span class="fighter-emoji">🗡️</span>
        </div>
        <div class="hub-hero-info">
            <h1 class="hub-hero-name">勇者</h1>
            <p class="hub-hero-title">初心冒险者</p>
        </div>
        <div class="hub-gold-large">
            <span class="gold-icon">🪙</span>
            <span id="hub-gold-value">0</span>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav id="hub-nav">
        <button class="hub-tab active" data-panel="cards">🃏 卡牌</button>
        <button class="hub-tab" data-panel="skills">🔮 技能</button>
        <button class="hub-tab" data-panel="shop">🏪 商店</button>
    </nav>

    <!-- Cards Panel -->
    <section id="panel-cards" class="hub-panel">
        <div class="panel-header">
            <h2>装备卡牌</h2>
            <span class="slot-counter" id="card-counter">0 / 4</span>
        </div>
        <div class="equipped-zone" id="equipped-cards">
            <!-- Populated by JS -->
        </div>
        <div class="divider">
            <span>可用卡牌</span>
        </div>
        <div class="available-zone" id="available-cards">
            <!-- Populated by JS -->
        </div>
    </section>

    <!-- Skills Panel -->
    <section id="panel-skills" class="hub-panel hidden">
        <div class="panel-header">
            <h2>装备技能</h2>
            <span class="slot-counter" id="skill-counter">0 / 2</span>
        </div>
        <div class="equipped-zone" id="equipped-skills">
            <!-- Populated by JS -->
        </div>
        <div class="divider">
            <span>可用技能</span>
        </div>
        <div class="available-zone" id="available-skills">
            <!-- Populated by JS -->
        </div>
    </section>

    <!-- Shop Panel (TODO) -->
    <section id="panel-shop" class="hub-panel hidden">
        <div class="shop-placeholder">
            <div class="shop-icon">🏪</div>
            <h2>商店</h2>
            <p>商店正在建设中，敬请期待！</p>
            <p class="shop-hint">未来将支持使用金币购买新卡牌和技能</p>
        </div>
    </section>

    <!-- Start Battle Button -->
    <div id="battle-action">
        <a href="battle.html" id="btn-battle" class="battle-btn">⚔️ 开始战斗</a>
    </div>
</div>

<!-- Game-over overlay -->
<div id="overlay" class="overlay hidden">
    <div class="overlay-box">
        <div id="result-icon"></div>
        <h2 id="result-title"></h2>
        <p id="result-detail"></p>
        <p id="result-gold" class="gold-reward hidden"></p>
        <button id="btn-restart">再来一局</button>
    </div>
</div>

<!-- Auth Modal -->
<div id="auth-modal" class="overlay hidden">
    <div class="overlay-box auth-box">
        <button id="btn-close-auth" class="modal-close">✕</button>
        <div id="auth-tabs">
            <button class="auth-tab active" data-tab="login">登录</button>
            <button class="auth-tab" data-tab="register">注册</button>
        </div>

        <form id="login-form" class="auth-form">
            <input type="email" id="login-email" placeholder="邮箱" required />
            <input type="password" id="login-password" placeholder="密码" required />
            <button type="submit" class="auth-submit">登录</button>
            <p id="login-error" class="auth-error hidden"></p>
        </form>

        <form id="register-form" class="auth-form hidden">
            <input type="text" id="reg-username" placeholder="用户名（2-20 字符）" required minlength="2" maxlength="20" />
            <input type="email" id="reg-email" placeholder="邮箱" required />
            <input type="password" id="reg-password" placeholder="密码（至少 6 位）" required minlength="6" />
            <button type="submit" class="auth-submit">注册</button>
            <p id="reg-error" class="auth-error hidden"></p>
        </form>
    </div>
</div>

<!-- Toast container -->
<div id="toast-container" style="position:fixed;bottom:40px;left:50%;transform:translateX(-50%);padding:12px 28px;background:#1e1e3a;border:2px solid #f0c850;border-radius:12px;color:#f0c850;font-size:0.95rem;font-weight:700;box-shadow:0 0 24px rgba(240,200,80,0.3),0 6px 24px rgba(0,0,0,0.5);z-index:9999;pointer-events:none;display:none;white-space:nowrap;"></div>

<script type="module" src="js/hub/hub.js"></script>
</body>
</html>
